<template>
  <VueContext class="context shadow2" ref="context"
              @close="$emit('close')" @open="onOpen"
              :close-on-click="false">
    <slot></slot>
  </VueContext>
</template>

<script>
import VueContext from 'vue-context';

export default {
  name: 'DaContext',
  components: { VueContext },

  methods: {
    open(event, data) {
      event.stopPropagation();
      setTimeout(() => this.$refs.context.open(event, data));
    },
    close() {
      this.$refs.context.close();
    },
    positionMenu({
      top, bottom, left, right,
    }) {
      const el = this.$refs.context.$el;
      const x = left || (right - el.offsetWidth);
      const y = top || (bottom - el.offsetHeight);
      this.$refs.context.positionMenu(y, x);
    },
    onOpen(...args) {
      this.$emit('open', ...args);
    },
  },
};
</script>

<style>
@import '~vue-context/dist/css/vue-context.css';

.context .btn {
  height: 41px;
  padding: 0 16px;
  margin: 0;
  border-bottom: 1px solid var(--theme-background-primary);
  cursor: pointer;
  --button-border-radius: 0;

  & {
    @mixin nuggets;
  }

  &:last-child {
    height: 40px;
    border-bottom: none;
  }
}
</style>
<style scoped>
.v-context.context {
  display: flex;
  width: auto;
  min-width: unset;
  flex-direction: column;
  padding: 0;
  background: var(--theme-background-highlight);
  border-radius: 4px;
  border: none;
  box-shadow: 0 var(--theme-shadow-offset) 32px 16px rgba(0,0,0,0.32);
}
</style>
